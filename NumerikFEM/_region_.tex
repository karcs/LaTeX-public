\message{ !name(NUMFEM.tex)}\documentclass[8pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\input{math.tex}
\begin{document}

\message{ !name(NUMFEM.tex) !offset(-3) }

\title{On the existence of certain generic and weakly generic arrangements in $\field_q^d$}
\author{Jakob Schneider}
\date{\today}
\maketitle

Let $K$ be a geometric $n$-dimensional simplicial complex embedded in $\reals^n$ triangulating the domain $\Omega$ to solve the boundary value problem
\begin{align}
-\Delta u &= f\\
\rest{u}_{\bound{\Omega}} &= 0\text{.}
\end{align}
Using linear FEM we calculate
\begin{align}
\inprod{\nabla{\phi_u}}{\nabla{\phi_v}}=\begin{cases} 0 &: \{u,v\}\not\in K\\
\beta_{uv} &: \{u,v\}\in K^{(2)}\\
\alpha_u &: u=v
\end{cases}\text{.}
\end{align}
Using barycentric coordinates in the $n$-simplex $\sigma\in K^{(n)}$ one gets
\begin{equation}
z=\sum_{u\in\sigma}{\frac{\det(z-\sigma\setminus\{u\})}{\det(u-\sigma\setminus\{u\})}u}=\sum_{u\in\sigma}{\lambda^u_{\sigma}(z)u}
\end{equation}
by interpolation of the identity. If $\{u,v\}\in K^{(2)}$ we get
\begin{align}
\beta_{uv}=\sum_{\substack{\sigma\in K^{(n)}\\ \{u,v\}\subseteq \sigma}}{\int_{\sigma}{\nabla{\phi_u}\nabla{\phi_v}}}=\sum_{\substack{\sigma\in K^{(n)}\\ \{u,v\}\subseteq \sigma}}{\int_{\sigma}{\nabla{\lambda^u_{\sigma}(z)}\nabla{\lambda^v_{\sigma}(z)}}\d{z}}\text{.}
\end{align}
Calculating the summands reveals
\begin{align}
\beta_{uv} & = \sum_{\substack{\sigma\in K^{(n)}\\ \{u,v\}\subseteq \sigma}}{\int_{\sigma}{\sum_{i=1}^n{\lambda^u_{\sigma}(e_i)\lambda^v_{\sigma}(e_i)}}\d{z}}
= \sum_{\substack{\sigma\in K^{(n)}\\ \{u,v\}\subseteq \sigma}}{\vol(\sigma)\sum_{i=1}^n{\lambda^u_{\sigma}(e_i)\lambda^v_{\sigma}(e_i)}}\\
& = \sum_{\substack{\sigma\in K^{(n)}\\ \{u,v\}\subseteq \sigma}}{\frac{{(n-1)!}^2\vol(\sigma\setminus\{u\})\vol(\sigma\setminus\{v\})\inprod{\nu_{\sigma}(\sigma\setminus\{u\})}{\nu_{\sigma}(\sigma\setminus\{v\})}}{{n!}^2\vol(\sigma)}}\\
& = \sum_{\substack{\sigma\in K^{(n)}\\ \{u,v\}\subseteq \sigma}}{\frac{\vol(\sigma\setminus\{u\})\vol(\sigma\setminus\{v\})\inprod{\nu_{\sigma}(\sigma\setminus\{u\})}{\nu_{\sigma}(\sigma\setminus\{v\})}}{n^2\vol(\sigma)}}\text{.}
\end{align}
where $\nu_{\sigma}(\tau)$ denotes the outer unit normal vector of the face $\tau$ with respect to $\sigma$.
Now, observe that $\inprod{\nu_{\sigma}(\sigma\setminus\{u\})}{\nu_{\sigma}(\sigma\setminus\{v\})}=-\cos{\angle(\sigma\setminus\{u\},\sigma\setminus\{v\})}$ (the angle between the faces which is $<\pi$). Moreover, it is true that $\frac{n\vol(\sigma)}{\vol(\sigma\setminus\{u\})}=\vol(\{u,v\})\sin{\angle(\{u,v\},\sigma\setminus\{u\})}$ (and the analog identity for $v$ holds as well). Inserting this in the equation gives
\begin{align}
\beta_{uv} &= -\frac{1}{\vol(\{u,v\})^2}\sum_{\substack{\sigma\in K^{(n)}\\ \{u,v\}\subseteq \sigma}}{\frac{\vol(\sigma)\cos{\angle(\sigma\setminus\{u\},\sigma\setminus\{v\})}}{\sin{\angle(\{u,v\},\sigma\setminus\{u\})}\sin{\angle(\{u,v\},\sigma\setminus\{v\})}}}\text{.}
\end{align}
For the case $n=2$ this formula simplifies by using that for $\{u,v,w\}\in K^{(2)}$
\begin{align}
2\vol(\{u,v,w\}) &= \vol(\{u,w\})\vol(\{v,w\})\sin{\angle(\{u,w\},\{v,w\})}\\
 &= \vol(\{u,v\})^2\frac{\sin{\angle(\{u,v\},\{u,w\})}\sin{\angle(\{u,v\},\{v,w\})}}{\sin{\angle(\{u,w\},\{v,w\})}}.
\end{align}
The result is then
\begin{align}
\beta_{uv} &= -\frac{1}{2}\sum_{w\in K^{(0)}:\{u,v,w\}\in K^{(2)}}{\frac{\cos{\angle(\{u,w\},\{v,w\})}}{\sin{\angle(\{u,w\},\{v,w\})}}}\\
&= -\frac{1}{2}\sum_{w\in K^{(0)}:\{u,v,w\}\in K^{(2)}}{\cot{\angle(\{u,w\},\{v,w\})}}\text{.}
\end{align}
This last sum has at most two summands (depending on if $\{u,v\}$ lies in the boundary).
\end{document}

\message{ !name(NUMFEM.tex) !offset(-61) }
